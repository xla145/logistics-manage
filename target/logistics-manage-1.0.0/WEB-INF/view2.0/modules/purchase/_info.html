<#include "../../_layout/_layout2.0.html"><#t>
	<@header/>
	<div style="margin: 15px" >
		<form class="layui-form layui-form-pane" id="form-save">
			<div class="layui-form-item">
				<label class="layui-form-label"><span>*</span>单据日期：</label>
				<div class="layui-input-inline">
					<input type="text" name="peDate" class="layui-input"  value="${data.peDate?string('yyyy-MM-dd')}" id="activity-time">
					<input type="hidden" name="peId" value="${data.peId!''}" id="peId">
				</div>
				<label class="layui-form-label"><span>*</span>采购员：</label>
				<div class="layui-input-inline" style="width: 250px;">
					<input type="text" class="layui-input" name="purchaseName"  value="${data.purchaseName!''}">
				</div>
				<label class="layui-form-label"><span>*</span>默认仓库：</label>
				<div class="layui-input-inline">
					<select name="wid" lay-verify="required" lay-filter="vip">
						<option value="">请选择</option>
						<@module name="option" class="com.logistics.label.impl.GetWarehouseNode"  checked="${data.wid!''}"/>
					</select>
					<input type="hidden" name="vipName" value="${data.vipName!''}" id="vipName">
				</div>
			</div>
			<blockquote class="layui-elem-quote">
				<a href="javascript:void(0)" class="layui-btn layui-btn-sm operator-btn" data-type="addProduct"><i class="layui-icon">&#xe654;</i> 添加商品</a>
			</blockquote>
			<table id="product-table" lay-filter="product-table"></table>
		</form>
		<div class="product-amount">
			合计：<span class="count">${data.buyCount!0}</span> 总价：<span class="amount">${data.totalAmount!0}</span>
		</div>
	</div>
	<@footer>
	<script>
        //入口
        layui.use(['form','table'], function() {
            var $ = layui.jquery;
            var form = layui.form,table = layui.table;
			//列表渲染
			var tableIns = table.render({
				id: 'product-table',
				elem: '#product-table'
				,url: "${ctx}purchase/purchaseProductList"
				,where: {peId: $("#peId").val()}
				,height: 'full-175'
				,page: true
				,method: 'post'
				,request: {
					pageName: 'pageNo' //页码的参数名称，默认：page
					,limitName: 'pageSize' //每页数据量的参数名，默认：limit
				}
				,limits: [15,30,60,90,120]
				,limit: 15 //默认采用30
				,size: 'sm'
				,cols: [[
					{checkbox: true, fixed: true}
					,{field:'pid', title: '商品编码', width:150}
					,{field:'catName', title: '商品类型', width:100}
					,{field:'productPrice', title: '售价', width:80}
					,{field:'buyCount', title: '采购数量', width:80,templet: '#buyCount'}
                    ,{field:'wName', title: '仓库', width:120}
				]],
			});
        });
	</script>
</@footer>
